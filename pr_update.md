Closes #505

# ...paste the whole PR body from above here...
